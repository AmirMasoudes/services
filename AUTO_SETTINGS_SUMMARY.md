# خلاصه قابلیت‌های خودکار X-UI Bot

## 🎯 هدف
سیستم به صورت کاملاً خودکار کار می‌کند و نیازی به تنظیم دستی inbound ها نیست.

## ✨ قابلیت‌های جدید

### 1. ایجاد خودکار Inbound
- سیستم خودش inbound ها را در X-UI ایجاد می‌کند
- هر پروتکل inbound مخصوص خود را دارد
- نام‌گذاری خودکار: `AutoBot-{PROTOCOL}-{PORT}`

### 2. تنظیمات قابل تغییر
- تمام تنظیمات در فایل `xui_servers/settings.py` قرار دارد
- بدون نیاز به تغییر کد می‌توان تنظیمات را تغییر داد
- پشتیبانی از پروتکل‌های VMess، VLess و Trojan

### 3. مدیریت خودکار کاربران
- ایجاد خودکار کاربر در X-UI برای هر درخواست
- نام‌گذاری خودکار ایمیل‌ها
- مدیریت محدودیت‌های ترافیک و زمان

## 📁 فایل‌های جدید

### 1. `xui_servers/settings.py`
تنظیمات کامل سیستم شامل:
- پروتکل‌های مختلف
- پورت‌های پیش‌فرض
- زمان‌های انقضا
- فرمت‌های نام‌گذاری
- پیام‌های خطا و موفقیت

### 2. `xui_servers/README_SETTINGS.md`
راهنمای کامل تنظیمات با مثال‌های کاربردی

### 3. `test_auto_settings.py`
اسکریپت تست برای بررسی عملکرد سیستم

## 🔧 نحوه استفاده

### تغییر پروتکل پیش‌فرض
```python
# در xui_servers/settings.py
DEFAULT_PROTOCOL = "vless"  # تغییر به VLess
```

### تغییر مدت زمان پلن تستی
```python
EXPIRY_SETTINGS = {
    "trial_hours": 48,  # تغییر به 48 ساعت
    "paid_days": 30
}
```

### تغییر پورت‌های پیش‌فرض
```python
PORT_SETTINGS = {
    "default_ports": {
        "vmess": 8080,    # تغییر پورت VMess
        "vless": 443,
        "trojan": 443
    }
}
```

### تنظیم برای CDN
```python
PROTOCOL_SETTINGS["vmess"]["stream_settings"]["wsSettings"]["path"] = "/cdn"
PROTOCOL_SETTINGS["vless"]["stream_settings"]["wsSettings"]["path"] = "/cdn"
```

## 🚀 مزایا

### 1. سادگی استفاده
- نیازی به تنظیم دستی inbound ها نیست
- سیستم خودش همه چیز را مدیریت می‌کند

### 2. انعطاف‌پذیری
- تنظیمات قابل تغییر بدون تغییر کد
- پشتیبانی از پروتکل‌های مختلف

### 3. قابلیت اطمینان
- تست‌های کامل برای اطمینان از عملکرد
- مدیریت خطاهای مختلف

### 4. مقیاس‌پذیری
- امکان اضافه کردن پروتکل‌های جدید
- مدیریت چندین سرور X-UI

## 📊 نتایج تست

```
✅ تست Import تنظیمات
✅ تست تنظیمات پروتکل  
✅ تست تولیدکننده کانفیگ
✅ تست سرویس X-UI
✅ تست فرمت‌های نام‌گذاری
✅ تست پیام‌های خطا
✅ تست تنظیمات پورت

🎉 درصد موفقیت: 100%
```

## 🔄 جریان کار

### 1. درخواست کانفیگ تستی
```
کاربر → Bot → UserConfigService.create_trial_config()
→ XUIService.get_or_create_inbound() → ایجاد خودکار inbound
→ ایجاد کاربر در X-UI → تولید کانفیگ → ارسال به کاربر
```

### 2. درخواست کانفیگ پولی
```
کاربر → Bot → UserConfigService.create_paid_config()
→ XUIService.get_or_create_inbound() → ایجاد خودکار inbound
→ ایجاد کاربر در X-UI با محدودیت ترافیک → تولید کانفیگ → ارسال به کاربر
```

## 🛠️ تنظیمات پیش‌فرض

### پروتکل VMess
- پورت: 443
- شبکه: WebSocket
- مسیر: /
- امنیت: TLS

### پروتکل VLess
- پورت: 443
- شبکه: WebSocket
- مسیر: /
- امنیت: TLS

### پروتکل Trojan
- پورت: 443
- شبکه: TCP
- امنیت: TLS
- نیاز به گواهی SSL

## 📝 نکات مهم

1. **پس از تغییر تنظیمات، سرور را restart کنید**
2. **تنظیمات TLS برای Trojan باید با سرور شما مطابقت داشته باشد**
3. **پورت‌های انتخاب شده نباید در سرور استفاده شده باشند**
4. **تنظیمات WebSocket path باید با CDN شما مطابقت داشته باشد**

## 🎉 نتیجه

سیستم حالا کاملاً خودکار است و شما فقط نیاز دارید:
1. تنظیمات پروتکل مورد نظر را در `settings.py` تغییر دهید
2. سرور را restart کنید
3. سیستم خودش همه چیز را مدیریت می‌کند!

**دیگر نیازی به تنظیم دستی inbound ها نیست! 🚀** 