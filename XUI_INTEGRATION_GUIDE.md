# ุฑุงูููุง ฺฉูพุงุฑฺูโุณุงุฒ X-UI

## ๐ ุฎูุงุตู ุชุบุฑุงุช

ุงู ุฑุงูููุง ูุญูู ุงุณุชูุงุฏู ุงุฒ ุณุณุชู ุฌุฏุฏ ฺฉูพุงุฑฺูโุณุงุฒ X-UI ุฑุง ุชูุถุญ ูโุฏูุฏ ฺฉู ุจุฑ ุงุณุงุณ API ุฌุฏุฏ X-UI ุทุฑุงุญ ุดุฏู ุงุณุช.

## ๐ง ูฺฺฏโูุง ุฌุฏุฏ

### 1. ูุฑูุฏ ุฎูุฏฺฉุงุฑ ุงุฏููโูุง

- ฺฉุงุฑุจุฑุงู ุจุง ID ุชูฺฏุฑุงู ุงุฏูู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูุงุฑุฏ ูโุดููุฏ
- ูุงุฒ ุจู ุฑูุฒ ุนุจูุฑ ูุณุช
- ุฏุณุชุฑุณ ูุณุชูู ุจู ุชูุงู ูุงุจูุชโูุง

### 2. ูุฏุฑุช ูพุดุฑูุชู Inbound

- ููฺฏุงูโุณุงุฒ ุฎูุฏฺฉุงุฑ Inbound ูุง ุจุง ุฏุชุงุจุณ
- ุงูุชู ุจูุชุฑู Inbound ุจุฑุง ฺฉุงุฑุจุฑุงู
- ูพุดุชุจุงู ุงุฒ ฺฉูฺฉ 3x-ui ุจุฑุง ุงุญุฑุงุฒ ููุช

### 3. ูุฏุฑุช ฺฉูุงูุชโูุง

- ุงุฌุงุฏ ุฎูุฏฺฉุงุฑ ฺฉูุงูุชโูุง ุฏุฑ X-UI
- ุชููุฏ ฺฉุงููฺฏโูุง ูุฎุชูู (VLESS, VMess, Trojan)
- ูุฏุฑุช ูุญุฏูุฏุชโูุง ุชุฑุงูฺฉ ู ุฒูุงู

## ๐ ูุญูู ุงุณุชูุงุฏู

### ุชูุธู ุณุฑูุฑ X-UI

1. **ุงุถุงูู ฺฉุฑุฏู ุณุฑูุฑ ุฏุฑ ุฏุชุงุจุณ:**

```python
from xui_servers.models import XUIServer

server = XUIServer.objects.create(
    name="ุณุฑูุฑ ุงุตู",
    host="time.amirprogrammer.ir",
    port=50987,
    username="admin",
    password="your_password",
    web_base_path="/YvIhWQ3Pt6cHGXegE4/",
    is_active=True
)
```

2. **ุชูุธู ฺฉูฺฉ 3x-ui (ุงุฎุชุงุฑ):**

```python
# ุฏุฑ enhanced_api_models.py
if '3x-ui' in self._cookies:
    self.session.cookies.set('3x-ui', self._cookies['3x-ui'])
```

### ุงุณุชูุงุฏู ุงุฒ ุณุฑูุณโูุง ุฌุฏุฏ

#### 1. ููฺฏุงูโุณุงุฒ Inbound ูุง

```python
from xui_servers.enhanced_api_models import XUIInboundManager

# ููฺฏุงูโุณุงุฒ inbound ูุง
inbound_manager = XUIInboundManager(server)
synced_count = inbound_manager.sync_inbounds()
print(f"{synced_count} inbound ููฺฏุงูโุณุงุฒ ุดุฏ")

# ุงูุชู ุจูุชุฑู inbound
best_inbound = inbound_manager.find_best_inbound("vless")
```

#### 2. ุงุฌุงุฏ ฺฉูุงูุช

```python
from xui_servers.enhanced_api_models import XUIClientManager

# ุงุฌุงุฏ ฺฉูุงูุช
client_manager = XUIClientManager(server)
user_config = client_manager.create_user_config(user, plan, inbound)
```

#### 3. ุชููุฏ ฺฉุงููฺฏ

```python
# ุชููุฏ ฺฉุงููฺฏ VLESS Reality
config = client_manager._generate_vless_config(inbound, client_data)
```

## ๐ ุณุงุฎุชุงุฑ API ุฌุฏุฏ

### ุฏุฑุฎูุงุณุชโูุง API

#### 1. ุฏุฑุงูุช Inbound ูุง

```
GET /panel/api/inbounds/list
```

#### 2. ุงุถุงูู ฺฉุฑุฏู ฺฉูุงูุช

```
POST /panel/api/inbounds/addClient
Content-Type: application/json

{
    "id": 2,
    "settings": "{\"clients\": [{\"id\": \"uuid\", \"email\": \"user@example.com\", \"totalGB\": 10, \"expiryTime\": 0}]}"
}
```

### ุณุงุฎุชุงุฑ ฺฉูุงูุช

```json
{
  "id": "uuid-string",
  "flow": "",
  "email": "user@example.com",
  "limitIp": 0,
  "totalGB": 10,
  "expiryTime": 0,
  "enable": true,
  "tgId": "",
  "subId": "sub-id-string",
  "reset": 0
}
```

## ๐ ุงุญุฑุงุฒ ููุช

### ุฑูุด 1: ุชูฺฉู

```python
# ุฐุฎุฑู ุชูฺฉู ูพุณ ุงุฒ ูุงฺฏู
self._token = data.get('token')
self.session.headers.update({'Authorization': f'Bearer {self._token}'})
```

### ุฑูุด 2: ฺฉูฺฉ

```python
# ุฐุฎุฑู ฺฉูฺฉโูุง
self._cookies = response.cookies.get_dict()
self.session.cookies.update(self._cookies)
```

## ๐งช ุชุณุช ุณุณุชู

### ุงุฌุฑุง ุชุณุชโูุง

```bash
python test_xui_api.py
```

### ุชุณุชโูุง ููุฌูุฏ

1. **ุชุณุช ุงุชุตุงู:** ุจุฑุฑุณ ุงุชุตุงู ุจู X-UI
2. **ุชุณุช ูุฏุฑ Inbound:** ููฺฏุงูโุณุงุฒ ู ุงูุชู Inbound
3. **ุชุณุช ูุฏุฑ ฺฉูุงูุช:** ุชููุฏ ฺฉุงููฺฏ
4. **ุชุณุช ุงุฌุงุฏ ฺฉูุงูุช:** ุงุถุงูู ฺฉุฑุฏู ฺฉูุงูุช ุจู Inbound

## ๐ ุฏุณุชูุฑุงุช ุฑุจุงุช ุงุฏูู

### ุฏุณุชูุฑุงุช ุฌุฏุฏ

- `/sync_xui` - ููฺฏุงูโุณุงุฒ ุจุง X-UI
- `/inbounds` - ูุฏุฑุช Inbound ูุง
- `/clients` - ูุฏุฑุช ฺฉูุงูุชโูุง

### ูุซุงู ุงุณุชูุงุฏู

```
/sync_xui
โ ุณุฑูุฑ ุณุฑูุฑ ุงุตู: 2 inbound ููฺฏุงูโุณุงุฒ ุดุฏ
โ ููฺฏุงูโุณุงุฒ ฺฉุงูู ุดุฏ!
๐ ุชุนุฏุงุฏ ฺฉู inbound ูุง ููฺฏุงูโุณุงุฒ ุดุฏู: 2
```

## ๐ง ุชูุธูุงุช ูพุดุฑูุชู

### ุชูุธู ฺฉูฺฉ 3x-ui

```python
# ุฏุฑ enhanced_api_models.py
def add_client_to_inbound(self, inbound_id: int, client_data: Dict) -> bool:
    # ุงุถุงูู ฺฉุฑุฏู ฺฉูฺฉ 3x-ui
    if '3x-ui' in self._cookies:
        self.session.cookies.set('3x-ui', self._cookies['3x-ui'])
```

### ุชูุธู ูุญุฏูุฏุชโูุง ฺฉูุงูุช

```python
client_settings = {
    "clients": [{
        "id": client_id,
        "email": email,
        "totalGB": total_gb,  # ุญุฌู ุชุฑุงูฺฉ (GB)
        "expiryTime": expiry_time,  # ุฒูุงู ุงููุถุง (timestamp)
        "limitIp": 0,  # ูุญุฏูุฏุช IP
        "enable": True
    }]
}
```

## ๐จ ูฺฉุงุช ููู

### 1. ุงููุช

- ฺฉูฺฉโูุง ุฑุง ุฏุฑ ุฌุง ุงูู ุฐุฎุฑู ฺฉูุฏ
- ุงุฒ HTTPS ุจุฑุง ุงุชุตุงู ุงุณุชูุงุฏู ฺฉูุฏ
- ุฑูุฒูุง ุนุจูุฑ ุฑุง ุฏุฑ ูุงูโูุง ุฌุฏุงฺฏุงูู ูฺฏูุฏุงุฑ ฺฉูุฏ

### 2. ุนููฺฉุฑุฏ

- ููฺฏุงูโุณุงุฒ ุฑุง ุจู ุตูุฑุช ุฏูุฑูโุง ุงูุฌุงู ุฏูุฏ
- ุงุฒ timeout ููุงุณุจ ุจุฑุง ุฏุฑุฎูุงุณุชโูุง ุงุณุชูุงุฏู ฺฉูุฏ
- ุฎุทุงูุง ุฑุง ุจู ุฏุฑุณุช ูุฏุฑุช ฺฉูุฏ

### 3. ูฺฏูุฏุงุฑ

- ูุงฺฏโูุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- ุนููฺฉุฑุฏ ุณุณุชู ุฑุง ูุงูุชูุฑ ฺฉูุฏ
- ุจูโุฑูุฒุฑุณุงูโูุง X-UI ุฑุง ุฏูุจุงู ฺฉูุฏ

## ๐ ูพุดุชุจุงู

ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุดฺฉู:

1. ูุงู `test_xui_api.py` ุฑุง ุงุฌุฑุง ฺฉูุฏ
2. ูุงฺฏโูุง ุณุณุชู ุฑุง ุจุฑุฑุณ ฺฉูุฏ
3. ุชูุธูุงุช ุณุฑูุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
4. ุจุง ุชู ูพุดุชุจุงู ุชูุงุณ ุจฺฏุฑุฏ

## ๐ ุจูโุฑูุฒุฑุณุงูโูุง ุขูุฏู

- ูพุดุชุจุงู ุงุฒ ูพุฑูุชฺฉูโูุง ุฌุฏุฏ
- ุจูุจูุฏ ูุฏุฑุช ุชุฑุงูฺฉ
- ุงุถุงูู ฺฉุฑุฏู ูุงุจูุชโูุง ูุงูุชูุฑูฺฏ
- ุจูููโุณุงุฒ ุนููฺฉุฑุฏ
